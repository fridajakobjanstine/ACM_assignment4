---
title: "Helper_plots"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Packages
```{r}
library(pacman)
p_load(tidyverse, ggsci)

# draws_df = read.csv('draws_df.csv')
```


Different taus
```{r}
softmax <- function(x, tau){
  outcome = 1 / (1 + exp(-tau*x))
  return(outcome)
}


x_values = seq(-2,2, 0.1)
taus = seq(0.5,5,0.5)

tau_data <- tibble()
for (tau in taus){
  outcome = softmax(x_values, tau)
  temp = tibble(x=x_values, y = outcome, tau = rep(tau, length(x_values)))
  tau_data <- rbind(tau_data, temp)
}

softmaxplot <- tau_data %>% mutate(tau = as.factor(tau)) %>% 
  ggplot(aes(x,y, color = tau))+
  geom_line()+
  theme_bw()+
  scale_color_d3()+
  labs(x ="Temperature", y = "Probability of choosing condition 1")

ggsave("softmax_vis.png", softmaxplot, width = 10, height=8)
```

Agent behavior

Load data
```{r}
df <- read.csv("simulation_data.csv")
source("simulations.Rmd")
extra_cond <- simulation(alpha=0.4, trials = 10000, value = c(0.5, 0.5), tau=0.5)
df <- rbind(df, extra_cond)
```

```{r}
## Define function for plotting (take below and use)
est_reward <- function(alpha, df){
  plot <- df %>% 
        filter(true_alpha==alpha) %>%
        ggplot()+
        geom_point(aes(trial, value2), color="darkorange", alpha=0.1)+
        geom_hline(aes(yintercept = a1_intercept, color="True reward probability"), size=1.1)+
        geom_smooth(aes(trial, value2, color="Smoothed estimation"))+
        scale_color_manual(name="",
                           values=c("darkorange3","black"), 
                           guide=guide_legend(override.aes = list(color=c("darkorange3","black"))))+
        labs(x="Trial", y="Agent's estimated reward probability", title = paste("True learning rate =", alpha))+
        theme_classic()
  return(plot)
}
```


Does the agent learn the true probabilities?
```{r}
a1_intercept = 0.75
a2_intercept = 0.25
rm(plots)

p_04 = est_reward(0.4, df)
p_06 = est_reward(0.6, df)
p_08 = est_reward(0.8, df)
ggsave("fig/alpha_04.png", p_04, width = 10, height=8)
ggsave("fig/alpha_06.png", p_06, width = 10, height=8)
ggsave("fig/alpha_08.png", p_08, width = 10, height=8)
```







=======
Model checks
```{r}
# see posterior plots

# prior predictive checks / 


# 
```


Alpha estimation development
```{r}
recovery_df %>%
  pivot_longer(cols=c(alpha1_est, alpha2_est)) %>%
  ggplot(aes(value, color=name)) +
  geom_density() +
  facet_wrap(~n_trials)

```

```{r}
recovery_df %>%
  filter(n_trials == 100) %>%
  pivot_longer(cols=c(alpha1_est, alpha2_est)) %>%
  ggplot(aes(value, color=name)) +
  geom_density()
  

```